import e,{createContext as t,useContext as n,useState as r,useCallback as o,useEffect as a,memo as i}from"react";import m from"next/head";var c=t({setTheme:function(e){},themes:[]}),s=function(){return n(c)},d=function(t){var n=t.forcedTheme,i=t.disableTransitionOnChange,m=void 0!==i&&i,s=t.enableSystem,d=void 0===s||s,f=t.storageKey,v=void 0===f?"theme":f,y=t.themes,p=void 0===y?["light","dark"]:y,g=t.defaultTheme,T=void 0===g?d?"system":"light":g,w=t.attribute,E=void 0===w?"data-theme":w,S=t.value,b=t.children,k=r(function(){return l(v,T)}),x=k[0],L=k[1],I=r(function(){return l(v)}),_=I[0],C=I[1],M=S?Object.values(S):p,O=o(function(e,t){void 0===t&&(t=!0);var n=(null==S?void 0:S[e])||e,r=m?h():null;if(t)try{localStorage.setItem(v,e)}catch(e){}var o,a=document.documentElement;"class"===E?((o=a.classList).remove.apply(o,M),a.classList.add(n)):a.setAttribute(E,n),null==r||r()},[]),P=o(function(e){var t=e.matches?"dark":"light";C(t),"system"===x&&O(t,!1)},[x]);a(function(){if(d){var e=window.matchMedia("(prefers-color-scheme: dark)");return e.addListener(P),P(e),function(){return e.removeListener(P)}}},[P]);var H=o(function(e){n||(O(e),L(e))},[]);return a(function(){var e=function(e){e.key===v&&H(e.newValue)};return window.addEventListener("storage",e),function(){return window.removeEventListener("storage",e)}},[]),a(function(){"light"===x?document.documentElement.style.setProperty("color-scheme","light"):"dark"===x?document.documentElement.style.setProperty("color-scheme","dark"):"system"===x&&_&&document.documentElement.style.setProperty("color-scheme",_)},[x,_]),e.createElement(c.Provider,{value:{theme:x,setTheme:H,forcedTheme:n,resolvedTheme:"system"===x?_:x,themes:d?[].concat(p,["system"]):p,systemTheme:d?_:void 0}},e.createElement(u,{forcedTheme:n,storageKey:v,attribute:E,value:S,enableSystem:d,defaultTheme:T,attrs:M}),b)},u=i(function(t){var n=t.forcedTheme,r=t.storageKey,o=t.attribute,a=t.enableSystem,i=t.defaultTheme,c=t.value,s="class"===o?"var d=document.documentElement.classList;d.remove("+t.attrs.map(function(e){return"'"+e+"'"}).join(",")+");":"var d=document.documentElement;",d=function(e,t){e=(null==c?void 0:c[e])||e;var n=t?e:"'"+e+"'";return"class"===o?"d.add("+n+")":"d.setAttribute('"+o+"', "+n+")"},u="system"===i;return e.createElement(m,null,e.createElement("script",n?{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){"+s+d(n)+"}()"}}:a?{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){try {"+s+"var e=localStorage.getItem('"+r+"');"+(u?"":d(i)+";")+'if("system"===e||(!e&&'+u+')){var t="(prefers-color-scheme: dark)",m=window.matchMedia(t);m.media!==t||m.matches?'+d("dark")+":"+d("light")+"}else "+(c?"var x="+JSON.stringify(c)+";":"")+d(c?"x[e]":"e",!0)+"}catch(e){}}()"}}:{key:"next-themes-script",dangerouslySetInnerHTML:{__html:"!function(){try{"+s+'var e=localStorage.getItem("'+r+'");'+(u?"":d(i))+";"+(c?"var x="+JSON.stringify(c)+";":"")+d(c?"x[e]":"e",!0)+"}catch(t){}}();"}}))},function(e,t){return e.forcedTheme===t.forcedTheme}),l=function(e,t){if("undefined"!=typeof window){var n;try{n=localStorage.getItem(e)||void 0}catch(e){}return n||t}},h=function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),function(){window.getComputedStyle(document.body),setTimeout(function(){document.head.removeChild(e)},1)}};export{d as ThemeProvider,s as useTheme};
